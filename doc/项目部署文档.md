# AI智能面试宝典 - 项目部署文档

## 1. 项目概述
AI智能面试宝典是一个基于AI技术的面试辅助系统，旨在帮助用户准备面试，提高面试成功率。系统提供简历优化、自我介绍生成、智能题库、模拟面试和面试策略等功能。

## 2. 环境要求

### 2.1 硬件要求
- CPU：至少4核
- 内存：至少8GB
- 存储：至少50GB可用空间
- 网络：稳定的互联网连接（用于调用AI服务）

### 2.2 软件要求
- 操作系统：Linux/Unix（推荐Ubuntu 20.04+）
- Python：3.8+（用于后端开发）
- Node.js：16+（用于前端开发）
- MySQL：5.7+（数据库）
- Git：用于版本控制

## 3. 安装部署步骤

### 3.1 克隆代码仓库
```bash
git clone <仓库地址>
cd ai_interview2
```

### 3.2 安装依赖

#### 3.2.1 前端依赖
```bash
npm install
```

#### 3.2.2 后端依赖
```bash
cd backend
pip install -r requirements.txt
```

### 3.3 配置文件设置

#### 3.3.1 后端配置
创建并编辑 `backend/config.py` 文件：

```python
# 数据库配置
DATABASE_CONFIG = {
    "host": "localhost",
    "port": 3306,
    "user": "root",
    "password": "your_password",
    "database": "ai_interview"
}

# DeepSeek API配置
DEEPSEEK_CONFIG = {
    "api_key": "your_deepseek_api_key",
    "base_url": "https://api.deepseek.com",
    "model": "deepseek-chat"
}

# 简历配置
RESUME_CONFIG = {
    "base_path": "/path/to/resumes",
    "original_path": "original",
    "optimized_path": "optimized"
}

# 其他配置
SECRET_KEY = "your_secret_key"
DEBUG = False
```

#### 3.3.2 前端配置
根据需要调整 `vite.config.js` 文件：

```javascript
import { defineConfig } from 'vite'
import vue from '@vitejs/plugin-vue'

// https://vitejs.dev/config/
export default defineConfig({
  plugins: [vue()],
  server: {
    port: 5173,
    proxy: {
      '/api': {
        target: 'http://localhost:5000',
        changeOrigin: true
      }
    }
  }
})
```

### 3.4 数据库初始化

#### 3.4.1 创建数据库
```bash
mysql -u root -p
CREATE DATABASE ai_interview CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
```

#### 3.4.2 初始化表结构
```bash
cd backend
python init_db.py
```

### 3.5 启动服务

#### 3.5.1 开发环境启动

**前端**：
```bash
npm run dev
```

**后端**：
```bash
cd backend
python3 run.py
```

#### 3.5.2 生产环境部署

**前端构建**：
```bash
npm run build
```

**后端部署**（使用Gunicorn）：
```bash
cd backend
pip install gunicorn
```

创建Gunicorn配置文件 `gunicorn.conf.py`：
```python
bind = "0.0.0.0:5000"
workers = 4
worker_class = "gevent"
daemon = True
pidfile = "/var/run/gunicorn.pid"
accesslog = "/var/log/gunicorn/access.log"
errorlog = "/var/log/gunicorn/error.log"
loglevel = "info"
```

启动Gunicorn：
```bash
mkdir -p /var/log/gunicorn
gunicorn -c gunicorn.conf.py run:app
```

**配置Nginx**：

创建Nginx配置文件 `/etc/nginx/conf.d/ai_interview.conf`：

```nginx
server {
    listen 80;
    server_name your_domain.com;

    # 前端静态文件
    location / {
        root /path/to/ai_interview2/dist;
        index index.html;
        try_files $uri $uri/ /index.html;
    }

    # 后端API代理
    location /api {
        proxy_pass http://localhost:5000;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }
}
```

检查并启动Nginx：
```bash
nginx -t
nginx -s reload
```

## 4. 服务管理

### 4.1 启动服务

**前端开发服务**：
```bash
npm run dev
```

**后端开发服务**：
```bash
cd backend
python run.py
```

**后端生产服务**：
```bash
cd backend
# 使用start.sh脚本启动
bash start.sh
```

### 4.2 停止服务

**后端生产服务**：
```bash
# 查看进程ID
ps aux | grep gunicorn
# 杀死进程
kill -9 <pid>
```

### 4.3 查看日志

**前端日志**：
```bash
# 开发环境日志直接输出到终端
```

**后端日志**：
```bash
# 开发环境日志直接输出到终端

# 生产环境日志
cat /var/log/gunicorn/error.log
cat /var/log/gunicorn/access.log
```

## 5. 常见问题与解决方案

### 5.1 数据库连接失败
- 检查数据库配置是否正确
- 确保MySQL服务正在运行
- 检查数据库用户权限

### 5.2 AI服务调用失败
- 检查DeepSeek API密钥是否正确
- 确保网络连接正常
- 检查API请求格式是否正确

### 5.3 前端无法访问后端API
- 检查Nginx配置是否正确
- 确保Gunicorn服务正在运行
- 检查前端代理配置

### 5.4 文件上传失败
- 检查文件大小限制
- 确保文件存储目录存在且有写入权限
- 检查文件格式是否支持

## 6. 监控与维护

### 6.1 系统监控
- 使用Prometheus + Grafana监控系统性能
- 监控MySQL数据库状态
- 监控API请求频率和响应时间

### 6.2 日志管理
- 定期清理日志文件
- 配置日志轮转
- 监控关键错误日志

### 6.3 数据备份
- 定期备份MySQL数据库
- 备份重要的简历文件

### 6.4 安全更新
- 定期更新系统和依赖
- 监控安全漏洞
- 及时修复发现的问题

## 7. 系统架构图

```
┌─────────────────────────────────────────────────────────────────┐
│                      前端应用 (Vue 3 + Vite)                     │
├─────────────────────────────────────────────────────────────────┤
│  首页  │ 简历优化 │ 自我介绍 │ 智能题库 │ 模拟面试 │ 面试策略  │
└─────────────────────────────────────────────────────────────────┘
                              │ HTTP/HTTPS
┌─────────────────────────────────────────────────────────────────┐
│                          Nginx 反向代理                          │
└─────────────────────────────────────────────────────────────────┘
                              │
┌─────────────────────────────────────────────────────────────────┐
│                     后端服务 (Gunicorn + Flask)                 │
├─────────────────────────────────────────────────────────────────┤
│  API路由  │ 业务逻辑 │ AI服务集成 │ 数据库操作 │ 文件服务     │
└─────────────────────────────────────────────────────────────────┘
                              │
┌─────────────────────────────────────────────────────────────────┐
│                      数据库 (MySQL)                              │
├─────────────────────────────────────────────────────────────────┤
│  用户表  │ 简历表 │ 自我介绍表 │ 题库表 │ 模拟面试表 │ 策略表   │
└─────────────────────────────────────────────────────────────────┘
                              │
┌─────────────────────────────────────────────────────────────────┐
│                      AI服务 (DeepSeek API)                      │
└─────────────────────────────────────────────────────────────────┘
```

## 8. 版本更新说明

### 8.1 更新步骤
1. 拉取最新代码
   ```bash
   git pull origin main
   ```
2. 更新依赖
   ```bash
   npm install
   cd backend
   pip install -r requirements.txt
   ```
3. 重启服务

### 8.2 注意事项
- 更新前备份数据库和配置文件
- 检查更新日志，了解可能的配置变更
- 测试关键功能是否正常

## 9. 联系方式

- 项目维护者：<联系方式>
- 技术支持：<支持邮箱>
- 问题反馈：<反馈渠道>

## 10. 附录

### 10.1 端口占用情况
- 前端开发服务：5173
- 后端服务：5000
- MySQL：3306
- Nginx：80/443

### 10.2 常用命令

**启动前端开发服务**：
```bash
npm run dev
```

**构建前端生产版本**：
```bash
npm run build
```

**启动后端开发服务**：
```bash
cd backend
python run.py
```

**初始化数据库**：
```bash
cd backend
python init_db.py
```

**查看后端日志**：
```bash
cd backend
python run.py
```

**查看前端日志**：
```bash
npm run dev
```

**检查Nginx配置**：
```bash
nginx -t
```

**重启Nginx**：
```bash
nginx -s reload
```

**查看Gunicorn进程**：
```bash
ps aux | grep gunicorn
```

**终止Gunicorn进程**：
```bash
kill -9 <pid>
```

## 11. 部署架构说明

### 11.1 开发环境架构
- 前端：Vue 3 + Vite 开发服务器
- 后端：Flask 开发服务器
- 数据库：本地MySQL
- AI服务：DeepSeek API

### 11.2 生产环境架构
- 前端：静态文件部署在Nginx
- 后端：Gunicorn + Flask
- 数据库：独立MySQL服务器
- AI服务：DeepSeek API
- 负载均衡：Nginx反向代理

## 12. 性能优化建议

### 12.1 前端优化
- 开启Gzip压缩
- 使用CDN加速静态资源
- 配置浏览器缓存

### 12.2 后端优化
- 使用Redis缓存热点数据
- 优化数据库查询
- 增加Gunicorn worker数量

### 12.3 数据库优化
- 为频繁查询的字段添加索引
- 定期优化表结构
- 配置适当的连接池

### 12.4 AI服务优化
- 缓存AI服务响应结果
- 合理设置超时时间
- 实现重试机制

## 13. 安全配置建议

### 13.1 数据库安全
- 使用强密码
- 限制数据库访问IP
- 定期备份数据

### 13.2 API安全
- 实现接口限流
- 使用HTTPS协议
- 验证请求来源

### 13.3 服务器安全
- 配置防火墙规则
- 关闭不必要的端口
- 定期更新系统补丁

### 13.4 数据安全
- 敏感数据加密存储
- 定期清理无用数据
- 实施数据访问权限控制

## 14. 扩展建议

### 14.1 增加缓存层
- 引入Redis缓存
- 缓存AI服务响应
- 缓存热点数据

### 14.2 增加消息队列
- 使用Celery处理异步任务
- 异步处理文件上传
- 异步发送通知

### 14.3 增加监控系统
- 监控系统性能
- 监控API请求
- 监控数据库状态

### 14.4 增加日志系统
- 集中化日志管理
- 日志分析
- 异常告警

## 15. 总结

本部署文档详细介绍了AI智能面试宝典项目的部署步骤、服务管理、监控维护等内容。通过按照文档中的步骤进行部署，可以确保系统正常运行。同时，文档中还提供了性能优化、安全配置和扩展建议，帮助用户构建一个高可用、高性能的系统。

在实际部署过程中，建议根据具体的环境和需求进行适当的调整，确保系统能够稳定、高效地运行。